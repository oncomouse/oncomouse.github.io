<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<title>Attendance Curve Calculator</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cutestrap/1.3.1/css/cutestrap.min.css" />
</head>
<body>
	<div class="wrapper-small">
		<h1 class="page-title">Dr. Pilsch Absence Curve Calculator</h1>
		<p>
      In my English classes, points are lost for unexcused absences based on a curve. As you go beyond the allowed number of absences (usually 1 per unit), you lose points per absence. The value of points is attained by mapping from 2 absences to 10 absences to the range from 2 points to 5 points per absence. Above 10 absences, each one counts for 5 points.
    </p>
    <p>
      Enter a number of absences below to see how many points you will lose on the next paper with that number.
    </p>
	</div>
	<div class="wrapper-small">
		<div class="fw-semibold fs-large"><p>
      Points Lost for Attendance: <span id="absences-output"></span>
    </p></div>
		<form>
			<label for="absences" class="textfield">
				<input type="number" id="absences" value="0">
				<span class="textfield__label">My Absences During This Unit:</span>
			</label>
		</form>
	</div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ramda/0.25.0/ramda.min.js"></script>
  <script>
    var linearScale = R.curry(function (domain, range, n) {
      var domainMin = domain[0], domainMax = domain[1];
      var rangeMin = range[0], rangeMax = range[1];
      return rangeMin + (n - domainMin) * (rangeMax - rangeMin) / (domainMax - domainMin)
    });
    var freeAbsences = 1;
    var tooHighAbsences = 10;
    var minMultiplier = 2;
    var maxMultiplier = 5;
    var scalarMap = R.cond([
      [R.gte(tooHighAbsences), linearScale([freeAbsences + 1, tooHighAbsences], [minMultiplier, maxMultiplier])],
      [R.T, R.always(maxMultiplier)]
    ]);
    var curve = function(n) {
      return n <= freeAbsences ? 0 : Math.floor((n-1) * scalarMap(n));
    };
    function updateAbsences(ev) {
      ev.preventDefault();
      document.querySelector('#absences-output').innerHTML = curve(parseInt(document.querySelector('#absences').value))
    }
    document.addEventListener('DOMContentLoaded', updateAbsences);
    document.querySelector('#absences').addEventListener('change', updateAbsences)
  </script>
	</body>
</html>
